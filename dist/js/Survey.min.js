"use strict";class Survey{constructor(e,t,a){this.questions=[],this.options={},this.container=document.getElementById(e),this.container?(this.questions=t,a&&(this.options=a),this.render()):console.error("Could not find container element with ID "+e)}render(){const a=document.createElement("form");a.classList.add("surveyForm"),this.questions.forEach((e,t)=>{a.appendChild(this.createQuestion(e,t))});var e=document.createElement("input"),e=(e.type="submit",e.value="Submit",e.classList.add("btn"),e.classList.add("btn-primary"),a.appendChild(e),document.createElement("input"));e.type="button",e.value="Clear",e.classList.add("btn"),e.classList.add("btn-secondary"),e.addEventListener("click",()=>{a.reset()}),a.appendChild(e),this.container?.appendChild(a),a.addEventListener("submit",async e=>{e.preventDefault();e=this.getAnswers();if(console.table(e),this.options?.webhookUrl)try{var t=await fetch(this.options.webhookUrl,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});console.log("Webhook response:",await t.json())}catch(e){console.error("Webhook error:",e)}}),console.log(this.options.style),this.options?.style&&this.applyCSS(this.options.style)}createQuestion(a,n){const r=document.createElement("fieldset");var e=document.createElement("legend"),e=(e.textContent="Question "+(n+1),r.appendChild(e),document.createElement("label"));switch(e.classList.add("question-title"),e.textContent=a.text,a.required&&e.classList.add("required"),r.appendChild(e),a.type){case"text":case"email":case"tel":case"number":case"range":case"date":case"time":case"color":case"datetime-local":var t=this.createInputElement(a,"question-"+n);r.appendChild(t);break;case"radio":case"checkbox":a.options?.forEach(e=>{var t=this.createInputElement(a,"question-"+n),t=(t.value="string"==typeof e?e:e.value??e.label,r.appendChild(t),document.createElement("label"));t.textContent="string"==typeof e?e:e.label,t.classList.add("form-check-label"),r.appendChild(t)});break;case"select":t=this.createSelectElement(a,"question-"+n);r.appendChild(t);break;case"textarea":t=this.createTextAreaElement(a,"question-"+n);r.appendChild(t);break;case"image":t=this.createImageUploadInput(a,"question-"+n);r.appendChild(t);break;case"toggle":t=this.createBootstrapToggleInput(a,"question-"+n);r.appendChild(t);break;case"rating":t=this.createRatingInput(a,"question-"+n);r.appendChild(t)}return r}createInputElement(e,t){var a=document.createElement("input");return a.type=e.type,a.name=t,a.classList.add("checkbox"===e.type||"radio"===e.type||"color"===e.type?"form-check-input":"form-control"),e.required&&(a.required=!0),e.maxCharacters&&(a.maxLength=e.maxCharacters),e.placeholder&&(a.placeholder=e.placeholder),"number"!==e.type&&"range"!==e.type||(e.minValue&&(a.min=e.minValue.toString()),e.maxValue&&(a.max=e.maxValue.toString()),e.step&&(a.step=e.step.toString())),a}createSelectElement(e,t){const a=document.createElement("select");return a.name=t,a.classList.add("form-control"),e.required&&(a.required=!0),e.multiple&&(a.multiple=!0),e.options?.forEach(e=>{var t=document.createElement("option");t.value="string"==typeof e?e:e.value??e.label,t.textContent="string"==typeof e?e:e.label,a.appendChild(t)}),a}createTextAreaElement(e,t){var a=document.createElement("textarea");return a.name=t,a.classList.add("form-control"),e.required&&(a.required=!0),e.maxCharacters&&(a.maxLength=e.maxCharacters),e.placeholder&&(a.placeholder=e.placeholder),a}createBootstrapToggleInput(e,t){var a=document.createElement("div"),n=(a.classList.add("form-check","form-switch"),document.createElement("input")),t=(n.type="checkbox",n.name=t,n.classList.add("form-check-input"),e.required&&(n.required=!0),document.createElement("label"));return t.classList.add("form-check-label"),t.appendChild(n),a.appendChild(t),a}createImageUploadInput(e,t){var a=document.createElement("div"),n=(a.classList.add("image-upload-container"),document.createElement("input")),t=(n.type="file",n.name=t,n.accept="image/*",n.classList.add("image-upload-input"),e.required&&(n.required=!0),document.createElement("label")),e=(t.classList.add("image-upload-label"),document.createElement("div")),r=(e.classList.add("image-upload-dropzone"),document.createElement("i")),s=(r.classList.add("fas","fa-cloud-upload-alt","image-upload-icon"),document.createElement("span"));return s.textContent="Click to browse",s.classList.add("image-upload-text"),e.appendChild(r),e.appendChild(s),t.appendChild(e),t.appendChild(n),a.appendChild(t),n.addEventListener("change",this.handleImageUpload),a}createRatingInput(e,t){const a=document.createElement("div"),n=(a.classList.add("rating-input"),document.createElement("input"));n.type="hidden",n.name=t,a.appendChild(n);for(let e=1;e<=5;e++){var r=document.createElement("button");r.type="button",r.classList.add("btn","btn-outline-secondary","btn-sm"),r.textContent=e.toString(),a.appendChild(r),r.addEventListener("click",()=>{n.value=e.toString(),this.updateButtonStyles(a,e)})}return a}getAnswers(){var e,t,a=this.container?.querySelector("form"),n={};for([e,t]of new FormData(a).entries())n[e]?n[e].push(t):n[e]=[t];return n}applyCSS(e){var t=document.head||document.getElementsByTagName("head")[0],a=document.createElement("link");a.rel="stylesheet",a.href=`../dist/css/${e}.css`,t.appendChild(a)}handleImageUpload(e){var t,a=e.target.files;const n=document.querySelector(".image-upload-container");0!==a?.length&&n?((t=new FileReader).onload=e=>{var t=document.createElement("img");t.src=e.target?.result,n.appendChild(t)},null!==a&&t.readAsDataURL(a[0])):e.preventDefault()}updateButtonStyles(e,a){e.querySelectorAll("button").forEach((e,t)=>{t<a?(e.classList.remove("btn-outline-secondary"),e.classList.add("btn-primary")):(e.classList.remove("btn-primary"),e.classList.add("btn-outline-secondary"))})}}